<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Shrunken Master</title><link href="http://tokestermw.github.io/" rel="alternate"></link><link href="http://tokestermw.github.io/feeds/all.atom.xml" rel="self"></link><id>http://tokestermw.github.io/</id><updated>2013-04-10T00:00:00-07:00</updated><entry><title>My second article</title><link href="http://tokestermw.github.io/posts/my-second-article.html" rel="alternate"></link><updated>2013-04-10T00:00:00-07:00</updated><author><name>Motoki Wu</name></author><id>tag:tokestermw.github.io,2013-04-10:posts/my-second-article.html</id><summary type="html">&lt;p&gt;This is the content of my super blog post.&lt;/p&gt;
&lt;p&gt;$$
z = \sum_{k=1}^{|{\cal N}l|} \alpha{k}e^{-\frac{\left\| (x,y) - \mu_k(x,y) \right\|^2}{2{\sigma_k(x,y)^2} } }
$$&lt;/p&gt;
&lt;p&gt;&lt;span class="margin"&gt;this is some margin&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;library(rjson)&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# still need varying lags&lt;/span&gt;
&lt;span class="c1"&gt;## base delay diff operating model&lt;/span&gt;
opmodel &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; errR &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; errI &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; errN &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  beta &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;beta        &lt;span class="c1"&gt;# transformed steepness&lt;/span&gt;
  mu &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;mu          &lt;span class="c1"&gt;# mean of transformed steepness&lt;/span&gt;
  tau &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;tau         &lt;span class="c1"&gt;# sd of transformed steepness&lt;/span&gt;
  B0 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;B0          &lt;span class="c1"&gt;# unfished biomass&lt;/span&gt;
  p &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;p           &lt;span class="c1"&gt;# growth coefficient&lt;/span&gt;
  w &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;w           &lt;span class="c1"&gt;# w_k-1 / w_k&lt;/span&gt;
  M &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;M           &lt;span class="c1"&gt;# natural mortality&lt;/span&gt;
  sigR &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;sigR        &lt;span class="c1"&gt;# recruitment deviations&lt;/span&gt;
  qI &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;qI          &lt;span class="c1"&gt;# prop coeff for abundance&lt;/span&gt;
  sigI &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;sigI       &lt;span class="c1"&gt;# biomass observation errors&lt;/span&gt;
  sigN &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;sigN       &lt;span class="c1"&gt;# recruitment observation errors&lt;/span&gt;
  qN &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;qN         &lt;span class="c1"&gt;# prop coeff for recruitment&lt;/span&gt;
  q &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;q          &lt;span class="c1"&gt;# catchability?&lt;/span&gt;
  phiT &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; pars&lt;span class="p"&gt;$&lt;/span&gt;phiT     &lt;span class="c1"&gt;# autocorrelation on rec-devs&lt;/span&gt;

  h &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;.2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;beta&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;beta&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="c1"&gt;# beta &amp;lt;- log((h - 0.2) / (1 - h))&lt;/span&gt;

&lt;span class="c1"&gt;#  eps &amp;lt;- matrix(rnorm((max(T)+1)*m,0,1), max(T)+1, m)&lt;/span&gt;
&lt;span class="c1"&gt;# eps[t] = eps[t-1]*phiT + sqrt(1+phiT^2)eta[t]&lt;/span&gt;
  eps &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;k in &lt;span class="m"&gt;1&lt;/span&gt;:m&lt;span class="p"&gt;)&lt;/span&gt;
    eps&lt;span class="p"&gt;[,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; arima.sim&lt;span class="p"&gt;(&lt;/span&gt;list&lt;span class="p"&gt;(&lt;/span&gt;ar &lt;span class="o"&gt;=&lt;/span&gt; phiT&lt;span class="p"&gt;),&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;length&lt;span class="p"&gt;(&lt;/span&gt;errR&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; length&lt;span class="p"&gt;(&lt;/span&gt;errI&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; length&lt;span class="p"&gt;(&lt;/span&gt;errN&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    errR &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;eps&lt;span class="o"&gt;*&lt;/span&gt;sigR &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;sigR&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    errI &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;((&lt;/span&gt;max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;m&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;sigI&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;sigI&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;
    errN &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;((&lt;/span&gt;max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;m&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;sigN&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;sigN&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  R0 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; B0 &lt;span class="o"&gt;/&lt;/span&gt; phi0
 &lt;span class="c1"&gt;# print(q)&lt;/span&gt;
  phi &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;E &lt;span class="o"&gt;%*%&lt;/span&gt; diag&lt;span class="p"&gt;(&lt;/span&gt;q&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="c1"&gt;# matrix(exp(-q*E), T+1, m) # percent non-catch&lt;/span&gt;

  B &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# spawning stock biomass&lt;/span&gt;
  R &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# recruitment&lt;/span&gt;
  C &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# catch&lt;/span&gt;
  I &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# biomass index&lt;/span&gt;
  N &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; max&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;)&lt;/span&gt;    &lt;span class="c1"&gt;# recruitment index&lt;/span&gt;

  &lt;span class="c1"&gt;# first year&lt;/span&gt;
  B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; B0
  C&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; phi&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
  R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; BH&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,],&lt;/span&gt;R0&lt;span class="p"&gt;,&lt;/span&gt;h&lt;span class="p"&gt;,&lt;/span&gt;phi0&lt;span class="p"&gt;,&lt;/span&gt;errR&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt; &lt;span class="c1"&gt;# R0&lt;/span&gt;
  I&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qI&lt;span class="o"&gt;*&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;errI&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; 
  N&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qN&lt;span class="o"&gt;*&lt;/span&gt;R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;errN&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;

  &lt;span class="c1"&gt;# second year  &lt;/span&gt;
  R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; BH&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,],&lt;/span&gt;R0&lt;span class="p"&gt;,&lt;/span&gt;h&lt;span class="p"&gt;,&lt;/span&gt;phi0&lt;span class="p"&gt;,&lt;/span&gt;errR&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt; &lt;span class="c1"&gt;# assume B_2-L = B_1-L &lt;/span&gt;
  B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;M&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; p &lt;span class="o"&gt;-&lt;/span&gt; p&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;M&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
    p&lt;span class="o"&gt;*&lt;/span&gt;w&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;M&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;

  C&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; phi&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,])&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
  I&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qI &lt;span class="o"&gt;*&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; errI&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
  N&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qN &lt;span class="o"&gt;*&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; errN&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;

  &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;k in &lt;span class="m"&gt;1&lt;/span&gt;:m&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;t in &lt;span class="m"&gt;2&lt;/span&gt;:&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      R&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; BH&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;ifelse&lt;span class="p"&gt;(&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;),&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt;
                     R0&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt;h&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt;phi0&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt;errR&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;
      B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;p&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;M&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
        p&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;M&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
          p&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;w&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;M&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; C&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
      C&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; phi&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
      I&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qI &lt;span class="o"&gt;*&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; errI&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
      N&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; qN &lt;span class="o"&gt;*&lt;/span&gt; R&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; errN&lt;span class="p"&gt;[&lt;/span&gt;t&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  list&lt;span class="p"&gt;(&lt;/span&gt;B &lt;span class="o"&gt;=&lt;/span&gt; B&lt;span class="p"&gt;,&lt;/span&gt; I &lt;span class="o"&gt;=&lt;/span&gt; I&lt;span class="p"&gt;,&lt;/span&gt; C &lt;span class="o"&gt;=&lt;/span&gt; C&lt;span class="p"&gt;,&lt;/span&gt; R &lt;span class="o"&gt;=&lt;/span&gt; R&lt;span class="p"&gt;,&lt;/span&gt; N &lt;span class="o"&gt;=&lt;/span&gt; N&lt;span class="p"&gt;,&lt;/span&gt; E &lt;span class="o"&gt;=&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; mu &lt;span class="o"&gt;=&lt;/span&gt; mu&lt;span class="p"&gt;,&lt;/span&gt; tau &lt;span class="o"&gt;=&lt;/span&gt; tau&lt;span class="p"&gt;,&lt;/span&gt;
       p &lt;span class="o"&gt;=&lt;/span&gt; p&lt;span class="p"&gt;,&lt;/span&gt; w &lt;span class="o"&gt;=&lt;/span&gt; w&lt;span class="p"&gt;,&lt;/span&gt; M &lt;span class="o"&gt;=&lt;/span&gt; M&lt;span class="p"&gt;,&lt;/span&gt; phiT &lt;span class="o"&gt;=&lt;/span&gt; phiT&lt;span class="p"&gt;,&lt;/span&gt;
       h &lt;span class="o"&gt;=&lt;/span&gt; h&lt;span class="p"&gt;,&lt;/span&gt; beta &lt;span class="o"&gt;=&lt;/span&gt; beta&lt;span class="p"&gt;,&lt;/span&gt; phi &lt;span class="o"&gt;=&lt;/span&gt; phi&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="o"&gt;=&lt;/span&gt;L&lt;span class="p"&gt;,&lt;/span&gt; qI &lt;span class="o"&gt;=&lt;/span&gt; qI&lt;span class="p"&gt;,&lt;/span&gt; qN &lt;span class="o"&gt;=&lt;/span&gt; qN&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="o"&gt;=&lt;/span&gt;m&lt;span class="p"&gt;,&lt;/span&gt;
       q &lt;span class="o"&gt;=&lt;/span&gt; q&lt;span class="p"&gt;,&lt;/span&gt; B0 &lt;span class="o"&gt;=&lt;/span&gt; B0&lt;span class="p"&gt;,&lt;/span&gt; R0 &lt;span class="o"&gt;=&lt;/span&gt; R0&lt;span class="p"&gt;,&lt;/span&gt; phi0 &lt;span class="o"&gt;=&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; eps &lt;span class="o"&gt;=&lt;/span&gt; eps&lt;span class="p"&gt;,&lt;/span&gt;
       errR &lt;span class="o"&gt;=&lt;/span&gt; errR&lt;span class="p"&gt;,&lt;/span&gt; errI &lt;span class="o"&gt;=&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN &lt;span class="o"&gt;=&lt;/span&gt; errN&lt;span class="p"&gt;,&lt;/span&gt;
       sigR &lt;span class="o"&gt;=&lt;/span&gt; sigR&lt;span class="p"&gt;,&lt;/span&gt; sigI &lt;span class="o"&gt;=&lt;/span&gt; sigI&lt;span class="p"&gt;,&lt;/span&gt; sigN &lt;span class="o"&gt;=&lt;/span&gt; sigN&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## stock recruitment function&lt;/span&gt;
BH &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;,&lt;/span&gt; R0&lt;span class="p"&gt;,&lt;/span&gt; h&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; err&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  R &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="m"&gt;0.8&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;R0&lt;span class="o"&gt;*&lt;/span&gt;h&lt;span class="o"&gt;*&lt;/span&gt;B &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;phi0&lt;span class="o"&gt;*&lt;/span&gt;R0&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;h&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;h&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;B&lt;span class="p"&gt;)&lt;/span&gt;
  as.matrix&lt;span class="p"&gt;(&lt;/span&gt;R &lt;span class="o"&gt;*&lt;/span&gt; err&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## stagger the B and R data for meta-analysis&lt;/span&gt;
stagger &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;L&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; B&lt;span class="p"&gt;,&lt;/span&gt; R&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  B.stag &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; dim&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;,&lt;/span&gt; dim&lt;span class="p"&gt;(&lt;/span&gt;B&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
  R.stag &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; matrix&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; dim&lt;span class="p"&gt;(&lt;/span&gt;R&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;,&lt;/span&gt; dim&lt;span class="p"&gt;(&lt;/span&gt;R&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
  &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;k in &lt;span class="m"&gt;1&lt;/span&gt;:m&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    B.stag&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;:&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;),&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; B&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;:&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;),&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
    R.stag&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;:&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;L&lt;span class="p"&gt;),&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; R&lt;span class="p"&gt;[(&lt;/span&gt;L&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;:&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  list&lt;span class="p"&gt;(&lt;/span&gt;B &lt;span class="o"&gt;=&lt;/span&gt; B.stag&lt;span class="p"&gt;,&lt;/span&gt; R &lt;span class="o"&gt;=&lt;/span&gt; R.stag&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## wrapper for running the operating model just for one stock&lt;/span&gt;
opmodel.sing &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;k&lt;span class="p"&gt;,&lt;/span&gt; pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; errR&lt;span class="p"&gt;,&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  pars.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; with&lt;span class="p"&gt;(&lt;/span&gt;pars&lt;span class="p"&gt;,&lt;/span&gt; list&lt;span class="p"&gt;(&lt;/span&gt;beta&lt;span class="o"&gt;=&lt;/span&gt;beta&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt; mu&lt;span class="o"&gt;=&lt;/span&gt;mu&lt;span class="p"&gt;,&lt;/span&gt; tau&lt;span class="o"&gt;=&lt;/span&gt;tau&lt;span class="p"&gt;,&lt;/span&gt; B0&lt;span class="o"&gt;=&lt;/span&gt;B0&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt; p&lt;span class="o"&gt;=&lt;/span&gt;p&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt; w&lt;span class="o"&gt;=&lt;/span&gt;w&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt; M&lt;span class="o"&gt;=&lt;/span&gt;M&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;],&lt;/span&gt;
                            sigR&lt;span class="o"&gt;=&lt;/span&gt;sigR&lt;span class="p"&gt;,&lt;/span&gt; qI&lt;span class="o"&gt;=&lt;/span&gt;qI&lt;span class="p"&gt;,&lt;/span&gt; sigI&lt;span class="o"&gt;=&lt;/span&gt;sigI&lt;span class="p"&gt;,&lt;/span&gt; sigN&lt;span class="o"&gt;=&lt;/span&gt;sigN&lt;span class="p"&gt;,&lt;/span&gt; qN&lt;span class="o"&gt;=&lt;/span&gt;qN&lt;span class="p"&gt;,&lt;/span&gt; q&lt;span class="o"&gt;=&lt;/span&gt;q&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]))&lt;/span&gt;
  m.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
  &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="m"&gt;.&lt;/span&gt;k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;
  E.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; t&lt;span class="p"&gt;(&lt;/span&gt;t&lt;span class="p"&gt;(&lt;/span&gt;E&lt;span class="p"&gt;[,&lt;/span&gt;k&lt;span class="p"&gt;]))&lt;/span&gt;
  L.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; L &lt;span class="c1"&gt;# still needs changing&lt;/span&gt;
  phi0.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; phi0&lt;span class="p"&gt;[&lt;/span&gt;k&lt;span class="p"&gt;]&lt;/span&gt;
  errR.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; t&lt;span class="p"&gt;(&lt;/span&gt;t&lt;span class="p"&gt;(&lt;/span&gt;errR&lt;span class="p"&gt;[,&lt;/span&gt;k&lt;span class="p"&gt;]))&lt;/span&gt;
  errI.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; t&lt;span class="p"&gt;(&lt;/span&gt;t&lt;span class="p"&gt;(&lt;/span&gt;errI&lt;span class="p"&gt;[,&lt;/span&gt;k&lt;span class="p"&gt;]))&lt;/span&gt;
  errN.k &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; t&lt;span class="p"&gt;(&lt;/span&gt;t&lt;span class="p"&gt;(&lt;/span&gt;errN&lt;span class="p"&gt;[,&lt;/span&gt;k&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="c1"&gt;#  print(paste(&amp;quot;sing&amp;quot;, pars.k$q))&lt;/span&gt;
  opmodel&lt;span class="p"&gt;(&lt;/span&gt;pars.k&lt;span class="p"&gt;,&lt;/span&gt; m.k&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="m"&gt;.&lt;/span&gt;k&lt;span class="p"&gt;,&lt;/span&gt; E.k&lt;span class="p"&gt;,&lt;/span&gt; L.k&lt;span class="p"&gt;,&lt;/span&gt; phi0.k&lt;span class="p"&gt;,&lt;/span&gt; errR.k&lt;span class="p"&gt;,&lt;/span&gt; errI.k&lt;span class="p"&gt;,&lt;/span&gt; errN.k&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## wrapper for finding the right q&lt;/span&gt;
opmodel.dep &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;q.dep&lt;span class="p"&gt;,&lt;/span&gt; T_dep&lt;span class="p"&gt;,&lt;/span&gt; dep&lt;span class="p"&gt;,&lt;/span&gt; k&lt;span class="p"&gt;,&lt;/span&gt; pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt;
                        errR&lt;span class="p"&gt;,&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  pars&lt;span class="p"&gt;$&lt;/span&gt;q &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; q.dep
  out &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; opmodel&lt;span class="p"&gt;(&lt;/span&gt;pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; errR&lt;span class="p"&gt;,&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;out&lt;span class="p"&gt;$&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;T_dep&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; out&lt;span class="p"&gt;$&lt;/span&gt;B0&lt;span class="o"&gt;*&lt;/span&gt;dep&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## wrapper for finding perfect q&lt;/span&gt;
opmodel.pq &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;q.dep&lt;span class="p"&gt;,&lt;/span&gt; k&lt;span class="p"&gt;,&lt;/span&gt; T_dep&lt;span class="p"&gt;,&lt;/span&gt; dep&lt;span class="p"&gt;,&lt;/span&gt; pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt;
                       errR&lt;span class="p"&gt;,&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  out &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; opmodel.sing&lt;span class="p"&gt;(&lt;/span&gt;k&lt;span class="p"&gt;,&lt;/span&gt; pars&lt;span class="p"&gt;,&lt;/span&gt; m&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k-Variable"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; E&lt;span class="p"&gt;,&lt;/span&gt; L&lt;span class="p"&gt;,&lt;/span&gt; phi0&lt;span class="p"&gt;,&lt;/span&gt; errR&lt;span class="p"&gt;,&lt;/span&gt; errI&lt;span class="p"&gt;,&lt;/span&gt; errN&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;out&lt;span class="p"&gt;$&lt;/span&gt;B&lt;span class="p"&gt;[&lt;/span&gt;T_dep&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; out&lt;span class="p"&gt;$&lt;/span&gt;B0&lt;span class="o"&gt;*&lt;/span&gt;dep&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## h -&amp;gt; beta&lt;/span&gt;
h_to_beta &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;h&lt;span class="p"&gt;)&lt;/span&gt;
  log&lt;span class="p"&gt;((&lt;/span&gt;h &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; h&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;## beta -&amp;gt; h&lt;/span&gt;
beta_to_h &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;beta&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;exp&lt;span class="p"&gt;(&lt;/span&gt;beta&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;beta&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;## dnorm for h&lt;/span&gt;
beta_to_h.dnorm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;h&lt;span class="p"&gt;,&lt;/span&gt; mu&lt;span class="p"&gt;,&lt;/span&gt; sigma&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="c1"&gt;#  h &amp;lt;- (exp(beta) + .2) / (1 + exp(beta))&lt;/span&gt;
  beta &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; log&lt;span class="p"&gt;((&lt;/span&gt;h &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; h&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;h&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="m"&gt;.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;h&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; sqrt&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;pi&lt;span class="o"&gt;*&lt;/span&gt;sigma&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; exp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;beta &lt;span class="o"&gt;-&lt;/span&gt; mu&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;sigma&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## calculate 95% confidence intervals for steepness (h)&lt;/span&gt;
h_profCI &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;h_search&lt;span class="p"&gt;,&lt;/span&gt; h_obj&lt;span class="p"&gt;,&lt;/span&gt; h_prof&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  h_spline &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; splinefun&lt;span class="p"&gt;(&lt;/span&gt;h_prof&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; method &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;natural&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;((&lt;/span&gt;h_obj &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1.3527&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; h_spline&lt;span class="p"&gt;(&lt;/span&gt;h_search&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;## calculate 95% confidence intervals for steepness (beta)&lt;/span&gt;
beta_profCI &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;beta_search&lt;span class="p"&gt;,&lt;/span&gt; h_obj&lt;span class="p"&gt;,&lt;/span&gt; beta_prof&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  beta_spline &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; splinefun&lt;span class="p"&gt;(&lt;/span&gt;beta_prof&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; method &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;natural&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;((&lt;/span&gt;h_obj &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1.3527&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; beta_spline&lt;span class="p"&gt;(&lt;/span&gt;beta_search&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="intro"></category><category term="R Code"></category></entry></feed>